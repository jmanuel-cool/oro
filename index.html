<!DOCTYPE html>
<body>
  <h1><marquee>üìä Ahorro en Oro ‚Äì Patria</marquee></h1>
  <div class="container" id="datos">
    <div class="row"><div class="label">Cargando datos...</div></div>
  </div>
  <div class="footer">Actualizado en tiempo real</div>

  <script>
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQTJ6Vys8dAgzbmIPtbu8ytI9C25cvKobWTG7rBPYB-pjJ9mIXd_GsVIsf7tmne0FBrq0TCybEVvIUM/pub?gid=757563170&single=true&output=csv";

    async function cargarDatos() {
      try {
        const response = await fetch(CSV_URL);
        const text = await response.text();
        const lineas = text.trim().split('\n').filter(l => l.trim() !== '');
        
        let html = '';
        lineas.forEach(linea => {
          const valores = [];
          let current = '';
          let inQuotes = false;
          for (let char of linea) {
            if (char === '"') {
              inQuotes = !inQuotes;
            } else if (char === ',' && !inQuotes) {
              valores.push(current.trim());
              current = '';
            } else {
              current += char;
            }
          }
          valores.push(current.trim());

          if (valores.length >= 2) {
            const etiqueta = valores[0].replace(/"/g, '');
            const valor = valores[1].replace(/"/g, '');
            if (etiqueta || valor) {
              html += `<div class="row"><div class="label">${etiqueta}</div><div class="value">${valor}</div></div>`;
            }
          }
        });

        document.getElementById('datos').innerHTML = html || '<div class="row"><div class="label">Sin datos</div></div>';
      } catch (e) {
        document.getElementById('datos').innerHTML = `<div class="row"><div class="label">‚ùå Error al cargar</div></div>`;
        console.error("Error:", e);
      }
    }

    cargarDatos();
    setInterval(cargarDatos, 300000);
  </script>
</body>
</html>
